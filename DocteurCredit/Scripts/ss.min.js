/* Script# Runtime
 * Designed and licensed for use and distribution with Script#-generated scripts.
 * Copyright (c) 2012, Nikhil Kothari, and the Script# Project.
 * More information at http://scriptsharp.com
 */
"use strict";(function(a){function b(){var f="0",j="-",i="pending",m="done",e="",g=-1,d=false,c=true,h=".",b=null;function V(){}function k(a){return a!==b&&a!==undefined}function E(c,a){for(var b in a)c[b]=a[b];return c}function nb(a){return a.toLowerCase()=="true"}function ub(a){if(a[0]=="/"){var c=a.lastIndexOf("/");if(c>1){var d=a.substring(1,c),e=a.substr(c+1);return new RegExp(d,e)}}return b}function tb(a){return!a||!a.length?0:a.indexOf(h)>=0||a.indexOf("e")>=0||C(a,"f")||C(a,"F")?parseFloat(a):parseInt(a,10)}function Eb(b){var a=Date.parse(b);return isNaN(a)?undefined:new Date(a)}function Kb(a){return a>=0?Math.floor(a):Math.ceil(a)}function bc(){return new Date}function Xb(){var a=new Date;return new Date(a.getFullYear(),a.getMonth(),a.getDate())}function kb(a,b){return a===b?c:k(a)&&k(b)?a.getTime()==b.getTime():d}function hb(a){if(!k(a.stack)||!k(a.fileName)||!k(a.lineNumber))return;var b=a.stack.split("\n"),d=b[0],f=a.fileName+":"+a.lineNumber;while(k(d)&&d.indexOf(f)===g){b.shift();d=b[0]}var e=b[1];if(!k(e))return;var c=e.match(/@(.*):(\d+)$/);if(!k(c))return;b.shift();a.stack=b.join("\n");a.fileName=c[1];a.lineNumber=parseInt(c[2],10)}function Tb(e,b,c){var a=new Error(e);if(b)for(var d in b)a[d]=b[d];if(c)a.innerException=c;hb(a);return a}function Zb(b){console.assert(d,b);if(a.navigator)eval("debugger;")}function R(a){return a?typeof a=="string"?JSON.parse("("+a+")"):Array.prototype.slice.call(a):b}function xb(b,e){var a=b.indexOf(e);return a>=0?(b.splice(a,1),c):d}function Ab(a){for(var b in a)delete a[b]}function Db(b,a){return b[a]!==undefined}function G(b){if(Object.keys)return Object.keys(b);var a=[];for(var c in b)a.push(c);return a}function Hb(a){return G(a).length}function s(d,c){var a=g,e=c?c.length:d.length,f=c?function(){return{key:c[a],value:d[c[a]]}}:function(){return d[a]};this.current=b;this.moveNext=function(){a++;this.current=f();return a<e};this.reset=function(){a=g;this.current=b}}var gb={current:b,moveNext:function(){return d},reset:V};function Bb(a){return!k(a)?gb:a.getEnumerator?a.getEnumerator():a.length!==undefined?new s(a):new s(a,G(a))}function Vb(){this.count=0;this._items=[]}var Sb={clear:function(){this._items.length=0;this.count=0},contains:function(b){for(var a=this.count-1;a>=0;a--)if(this._items[a]===b)return c;return d},getEnumerator:function(){return new s(this._items.reverse())},peek:function(){return this._items[this.count-1]},push:function(a){this._items.push(a);this.count++},pop:function(){if(this.count){this.count--;return this._items.pop()}return undefined}};function Ub(){this.count=0;this._items=[];this._offset=0}function K(a){a._items=a._items.slice(a._offset);a._offset=0}var Rb={clear:function(){this._items.length=0;this._offset=0;this.count=0},contains:function(e){for(var a=this._offset,b=this._items.length;a<=b;a++)if(this._items[a]===e)return c;return d},dequeue:function(){var a=this;if(a.count){var b=a._items[a._offset];++a._offset*2>=a._items.length&&K(a);a.count--;return b}return undefined},enqueue:function(a){this._items.push(a);this.count++},getEnumerator:function(){this._offset!=0&&K(this);return new s(this._items)},peek:function(){return this._items.length?this._items[this._offset]:undefined}};function F(b,a){return typeof a=="number"?a>1?(new Array(a+1)).join(b):b:Array.prototype.join.call(arguments,e)}function q(a){return!a||!a.length}function zb(a){return q(a)||!a.replace(/^\s*/,e).length}function bb(a,b,c){a=a||e,b=b||e;c?(a=a.toUpperCase(),b=b.toUpperCase()):0;return a===b?0:a<b?g:1}var Z=/(\{[^\}^\{]+\})/g,z={};function Qb(b){var c=n,d=b,a=Array.prototype.slice.call(arguments,1);if(b.constructor!=String){c=b;d=a[0];a=a.slice(1)}return d.replace(Z,function(j,f){var i=parseInt(f.substr(1),10),b=a[i];if(!k(b))return e;var h=z[Q(b)];if(h){var d=e,g=f.indexOf(":");if(g>0)d=f.substring(g+1,f.length-1);if(d&&d!="i")return h(b,d,c)}return c==n?b.toString():b.toLocaleString()})}function Fb(a){return a.replace(/^\s*/,e)}function Pb(a){return a.replace(/\s*$/,e)}function yb(b,a){return q(a)?c:q(b)||a.length>b.length?d:b.substr(0,a.length)==a}function C(b,a){return q(a)?c:q(b)||a.length>b.length?d:b.substr(-a.length)==a}function l(a,b,c){return a.length<b?F(c||" ",b-a.length)+a:a}function Ib(a,b,c){return a.length<b?a+F(c||" ",b-a.length):a}function ob(b,a,c){return!c||a+c>b.length?b.substr(0,a):b.substr(0,a)+b.substr(a+c)}function mb(a,b,c){return!c?a:!b?c+a:a.substr(0,b)+c+a.substr(b)}function jb(c,b,a){return c.split(b).join(a||e)}function P(a){var c=function(){for(var e=arguments,d=b,c=0,f=a.length;c<f;c++)d=e.length?a[c].apply(b,e):a[c].call(b);return d};c._fnList=a;return c}function Yb(a,c){if(!c)return a;var f=b;a=typeof a=="string"?c[f=a]:a;var e=f?c.$$b||(c.$$b={}):b,d=e?e[f]:b;if(!d){d=function(){return a.apply(c,arguments)};if(e)e[f]=d}return d}function Lb(a,b){if(!a)return b;if(!b)return a;var c=[].concat(a._fnList||a,b);return P(c)}function Mb(c,e){if(!c)return b;if(!e)return c;var a=c._fnList||[c],d=a.indexOf(e);if(d>=0){if(a.length==1)return b;a=d?a.slice(0,d).concat(a.slice(d+1)):a.slice(1);return P(a)}return c}function vb(f,g,c,d){c=c||"__"+(new Date).valueOf();d=d||a;var e={name:c,detach:function(){d[c]=V},dispose:function(){try{delete d[c]}catch(a){d[c]=undefined}}};d[c]=g?f:function(){e.dispose();return f.apply(b,arguments)};return e}function t(){}t.Empty=new t;function ab(){this.cancel=d}function pb(){}function J(){}function qb(){}function Cb(){}function lb(){}function wb(){}function eb(){}function ib(){}function db(){}function I(a){this._parts=k(a)&&a!==e?[a]:[];this.isEmpty=this._parts.length==0}var fb={append:function(a){if(k(a)&&a!==e){this._parts.push(a);this.isEmpty=d}return this},appendLine:function(b){var a=this;a.append(b);a.append("\r\n");a.isEmpty=d;return a},clear:function(){this._parts=[];this.isEmpty=c},toString:function(a){return this._parts.join(a||e)}},w=[],X={dispose:function(){w.pop()}};function r(a){var d=w,e=d.length;if(e){a=a||[];for(var c=0;c<e;c++){var f=d[c];a.indexOf(f)<0&&a.push(f)}return a}return b}function H(b){for(var a=0,c=b.length;a<c;a++)b[a].invalidateObserver()}function M(a){this._v=a;this._observers=b}var sb={getValue:function(){this._observers=r(this._observers);return this._v},setValue:function(d){var a=this;if(a._v!==d){a._v=d;var c=a._observers;if(c){a._observers=b;H(c)}}}};M.registerObserver=function(a){w.push(a);return X};function Y(a){this._items=a||[];this._observers=b}var W={get_item:function(a){this._observers=r(this._observers);return this._items[a]},set_item:function(a,b){this._items[a]=b;this._updated()},get_length:function(){this._observers=r(this._observers);return this._items.length},add:function(a){this._items.push(a);this._updated()},clear:function(){this._items.clear();this._updated()},contains:function(a){return this._items.indexOf(a)>=0},getEnumerator:function(){this._observers=r(this._observers);return this._items.getEnumerator()},indexOf:function(a){return this._items.indexOf(a)},insert:function(a,b){this._items.insert(a,b);this._updated()},remove:function(a){if(this._items.remove(a)){this._updated();return c}return d},removeAt:function(a){this._items.splice(a,1);this._updated()},toArray:function(){return this._items},_updated:function(){var a=this._observers;if(a){this._observers=b;H(a)}}};function p(c){var a=this;a._continuations=k(c)?(a.status=m,b):(a.status=i,[]);a.result=c;a.error=b}var Wb={get_completed:function(){return this.status!=i},continueWith:function(b){var a=this;if(a._continuations)a._continuations.push(b);else{var c=a;setTimeout(function(){b(c)},0)}return a},done:function(a){return this.continueWith(function(b){b.status==m&&a(b.result)})},fail:function(a){return this.continueWith(function(b){b.status=="failed"&&a(b.error)})},then:function(a,b){return this.continueWith(function(c){c.status==m?a(c.result):b(c.error)})}};function o(a,f,e){if(a.status==i){if(e){a.error=e;a.status="failed"}else{a.result=f;a.status=m}var d=a._continuations;a._continuations=b;for(var c=0,g=d.length;c<g;c++)d[c](a)}}function N(a,k){a=R(a);var f=a.length,g=0;if(f>1&&typeof a[0]=="number"){g=a[0];a=a.slice(1);f--}var e=new p,j=0;function l(a){if(e.status==i){j++;if(k)o(e,a);else j==f&&o(e,c)}}function m(){if(e.status==i)if(k)o(e,b);else o(e,d)}g!=0&&setTimeout(m,g);for(var h=0;h<f;h++)a[h].continueWith(l);return e}p.all=function(){return N(arguments,d)};p.any=function(){return N(arguments,c)};p.delay=function(b){var a=new p;setTimeout(function(){o(a,c)},b);return a};function Gb(c){var a=new p(c);return{task:a,resolve:function(b){o(a,b)},reject:function(c){o(a,b,c||new Error)}}}var n={name:e,nf:{nan:"NaN",neg:j,pos:"+",negInf:"-Infinity",posInf:"Infinity",gw:[3],dd:2,ds:h,gs:",",per:"%",perGW:[3],perDD:2,perDS:h,perGS:",",perPP:"{0} %",perNP:"-{0} %",cur:"$",curGW:[3],curDD:2,curDS:h,curGS:",",curNP:"(${0})",curPP:"${0}"},dtf:{am:"AM",pm:"PM",ds:"/",ts:":",gmt:"ddd, dd MMM yyyy HH:mm:ss 'GMT'",uni:"yyyy-MM-dd HH:mm:ssZ",sort:"yyyy-MM-ddTHH:mm:ss",dt:"dddd, MMMM dd, yyyy h:mm:ss tt",ld:"dddd, MMMM dd, yyyy",sd:"M/d/yyyy",lt:"h:mm:ss tt",st:"h:mm tt",day0:0,day:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],sday:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],mday:["Su","Mo","Tu","We","Th","Fr","Sa"],mon:["January","February","March","April","May","June","July","August","September","October","November","December",e],smon:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",e]}},cb={name:"en-us",dtf:n.dtf,nf:n.nf};function u(a,n,s,t){var g=b,m=a.indexOf(s);if(m>0){g=a.substr(m);a=a.substr(0,m)}var o=a.startsWith(j);if(o)a=a.substr(1);var k=0,l=n[k];if(a.length<l)return g?a+g:a;var p=a.length,f=e,q=d;while(!q){var i=l,h=p-i;if(h<0){l+=h;i+=h;h=0;q=c}if(!i)break;var r=a.substr(h,i);if(f.length)f=r+t+f;else f=r;p-=i;if(k<n.length-1){k++;l=n[k]}}if(o)f=j+f;return g?f+g:f}z.Number=function(d,n,k){var b=k.nf,a=e,c=g;if(n.length>1)c=parseInt(n.substr(1));var m=n.charAt(0);switch(m){case"d":case"D":a=parseInt(Math.abs(d)).toString();if(c!=g)a=l(a,c,f);if(d<0)a=j+a;break;case"x":case"X":a=parseInt(Math.abs(d)).toString(16);if(m=="X")a=a.toUpperCase();if(c!=g)a=l(a,c,f);break;case"e":case"E":if(c==g)a=d.toExponential();else a=d.toExponential(c);if(m=="E")a=a.toUpperCase();break;case"f":case"F":case"n":case"N":if(c==g)c=b.dd;a=d.toFixed(c).toString();if(c&&b.ds!=h){var i=a.indexOf(h);a=a.substr(0,i)+b.ds+a.substr(i+1)}if(m=="n"||m=="N")a=u(a,b.gw,b.ds,b.gs);break;case"c":case"C":if(c==g)c=b.curDD;a=Math.abs(d).toFixed(c).toString();if(c&&b.curDS!=h){var i=a.indexOf(h);a=a.substr(0,i)+b.curDS+a.substr(i+1)}a=u(a,b.curGW,b.curDS,b.curGS);if(d<0)a=String.format(k,b.curNP,a);else a=String.format(k,b.curPP,a);break;case"p":case"P":if(c==g)c=b.perDD;a=(Math.abs(d)*100).toFixed(c).toString();if(c&&b.perDS!=h){var i=a.indexOf(h);a=a.substr(0,i)+b.perDS+a.substr(i+1)}a=u(a,b.perGW,b.perDS,b.perGS);if(d<0)a=String.format(k,b.perNP,a);else a=String.format(k,b.perPP,a)}return a};var x=/'.*?[^\\]'|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z/g;z.Date=function(b,d,m){if(d=="iso")return b.toISOString();else if(d.charAt(0)=="i"){var h="String";switch(d){case"id":h="DateString";break;case"it":h="TimeString"}return m==n?b["to"+h]():b["toLocale"+h]()}var e=m.dtf;if(d.length==1)switch(d){case"f":d=e.ld+" "+e.st;break;case"F":d=e.dt;break;case"d":d=e.sd;break;case"D":d=e.ld;break;case"t":d=e.st;break;case"T":d=e.lt;break;case"g":d=e.sd+" "+e.st;break;case"G":d=e.sd+" "+e.lt;break;case"R":case"r":e=n.dtf;d=e.gmt;break;case"u":d=e.uni;break;case"U":d=e.dt;b=new Date(b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDate(),b.getUTCHours(),b.getUTCMinutes(),b.getUTCSeconds(),b.getUTCMilliseconds());break;case"s":d=e.sort}if(d.charAt(0)=="%")d=d.substr(1);var k=new I;x.lastIndex=0;while(c){var o=x.lastIndex,i=x.exec(d);k.append(d.slice(o,i?i.index:d.length));if(!i)break;var g=i[0],a=g;switch(g){case"dddd":a=e.day[b.getDay()];break;case"ddd":a=e.sday[b.getDay()];break;case"dd":a=l(b.getDate().toString(),2,f);break;case"d":a=b.getDate();break;case"MMMM":a=e.mon[b.getMonth()];break;case"MMM":a=e.smon[b.getMonth()];break;case"MM":a=l((b.getMonth()+1).toString(),2,f);break;case"M":a=b.getMonth()+1;break;case"yyyy":a=b.getFullYear();break;case"yy":a=l((b.getFullYear()%100).toString(),2,f);break;case"y":a=b.getFullYear()%100;break;case"h":case"hh":a=b.getHours()%12;if(!a)a="12";else if(g=="hh")a=l(a.toString(),2,f);break;case"HH":a=l(b.getHours().toString(),2,f);break;case"H":a=b.getHours();break;case"mm":a=l(b.getMinutes().toString(),2,f);break;case"m":a=b.getMinutes();break;case"ss":a=l(b.getSeconds().toString(),2,f);break;case"s":a=b.getSeconds();break;case"t":case"tt":a=b.getHours()<12?e.am:e.pm;if(g=="t")a=a.charAt(0);break;case"fff":a=l(b.getMilliseconds().toString(),3,f);break;case"ff":a=l(b.getMilliseconds().toString(),3).substr(0,2);break;case"f":a=l(b.getMilliseconds().toString(),3).charAt(0);break;case"z":a=b.getTimezoneOffset()/60;a=(a>=0?j:"+")+Math.floor(Math.abs(a));break;case"zz":case"zzz":a=b.getTimezoneOffset()/60;a=(a>=0?j:"+")+l(Math.floor(Math.abs(a)).toString(),2,f);if(g=="zzz")a+=e.ts+l(Math.abs(b.getTimezoneOffset()%60).toString(),2,f);break;default:if(a.charAt(0)=="'")a=a.substr(1,a.length-2).replace(/\\'/g,"'")}k.append(a)}return k.toString()};var D={},y="class",v="interface";function L(e,b,f){if(Array.isArray(b)){var a=b[0];if(b.length>=2){var c=b[2];if(c){var d=function(){};d.prototype=c.prototype;a.prototype=new d;a.prototype.constructor=a}b[1]&&E(a.prototype,b[1]);a.$base=c||Object;a.$interfaces=b.slice(3);a.$type=y}else a.$type=v;a.$name=e;return f[e]=a}return b}function Ob(a){return a.$type==y}function rb(a){return a.$type==v}function T(b){var a;try{a=b.constructor}catch(c){}return a||Object}function ac(d){var c=d.indexOf(h),e=c>0?D[d.substr(0,c)]:a,f=c>0?d.substr(c+1):d;return e?e[f]:b}var B=[Number,"Number",String,"String",Boolean,"Boolean",Array,"Array",Date,"Date",RegExp,"RegExp",Function,"Function"];function Q(a){if(!(a instanceof Function))a=a.constructor;if(a.$name)return a.$name;if(a.name)return a.name;for(var b=0,c=B.length;b<c;b+=2)if(a==B[b])return B[b+1];return"Object"}function O(b,e){if(b==Object||b==e)return c;if(b.$type==y){var a=e.$base;while(a){if(b==a)return c;a=a.$base}}else if(b.$type==v){var a=e;while(a){var f=a.$interfaces;if(f&&f.indexOf(b)>=0)return c;a=a.$base}}return d}function A(b,a){if(!k(a))return d;if(b==Object||a instanceof b)return c;var e=T(a);return O(b,e)}function Nb(a,b){return A(b,a)}function Jb(a,c){return A(c,a)?a:b}function U(a,b){var c=a.constructor.$base||a.$base,d=c.prototype[b];return d!==a[b]?d:U(c,b)}function S(e,b,c){var d=D[e]={$name:e};if(b)for(var a in b)L(a,b[a],d);var f={};if(c)for(var a in c)f[a]=L(a,c[a],d);return f}return E(S("ss",b,{IDisposable:[pb],IEnumerable:[J],IEnumerator:[qb],IObserver:[Cb],IApplication:[lb],IContainer:[wb],IObjectFactory:[eb],IEventManager:[ib],IInitializable:[db],EventArgs:[t,{}],CancelEventArgs:[ab,{},t],StringBuilder:[I,fb],Stack:[Vb,Sb],Queue:[Ub,Rb],Observable:[M,sb],ObservableCollection:[Y,W,b,J],Task:[p,Wb]}),{version:"0.8",isValue:k,extend:E,keys:G,keyCount:Hb,keyExists:Db,clearKeys:Ab,enumerate:Bb,array:R,remove:xb,"boolean":nb,regexp:ub,number:tb,date:Eb,truncate:Kb,now:bc,today:Xb,compareDates:kb,error:Tb,string:F,emptyString:q,whitespace:zb,format:Qb,compareStrings:bb,startsWith:yb,endsWith:C,padLeft:l,padRight:Ib,trimStart:Fb,trimEnd:Pb,insertString:mb,removeString:ob,replaceString:jb,bind:Yb,bindAdd:Lb,bindSub:Mb,bindExport:vb,deferred:Gb,module:S,modules:D,isClass:Ob,isInterface:rb,typeOf:T,type:ac,typeName:Q,canCast:Nb,safeCast:Jb,canAssign:O,instanceOf:A,base:U,culture:{neutral:n,current:cb},fail:Zb})}function c(){var c=b();typeof exports=="object"?c.extend(exports,c):(a.ss=c)}a.define?a.define("ss",[],b):c()})(this)